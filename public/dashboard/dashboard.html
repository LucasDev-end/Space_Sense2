<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="shortcut icon" href="./assets/img/logo.png" type="image/x-icon">
    <script src="../js/sessao.js"></script>
    <title>Space Sense | DashBoard</title>
</head>
<body onload="validarSessao()">
    <div class="container">
        <div class="side">
            <div class="user">
                <div class="line">
                    <div class="foto"><img src="../assets/icons/file.png"></div>
                    <h3>Olá, Boas Vindas <span id="b_usuario">usuário</span>!</h3>
                </h3>
                </div>
            </div>
            <div class="box">
                <div class="menu">
                    <div> <a href="dashboard.html">Dashboard</a></div>
                    <div><a href="setores.html">Setores</a></div>
                    <div><a href="heatmap.html">Mapa de Calor</a></div>
                </div>
                <div class="sair">
                    <div>
                        <h2><a href="../index.html"><span>SAIR</span></a></h2>
                    </div>
                </div>
            </div>
        </div>
        <div class="dashboard">
            <div class="grafico-esquerda">
                <div class="kpi">
                    <div class="box-kpi">
                        <div class="titulo">
                            <h2>Setor em<strong> Alta</strong></h2>
                        </div>
                        <div class="kpi-num" style="background-color: #37ad74;">
                            5.872
                        </div>
                        <div class="kpi-sub-texto" style="background-color: #37ad74;">
                            <h4>Carnes</h4>
                            <span class="seta-cima"></span>
                        </div>
                    </div>
                    <div class="box-kpi">
                        <div class="titulo">
                            <h2>Setor em<span> Declínio</span></h2>
                        </div>
                        <div class="kpi-num" style="color: #ffffff; background-color: #eb6767;">
                            1.505
                        </div>
                        <div class="kpi-sub-texto" style="color: #ffffff; background-color: #eb6767;">
                            <h4>Hortifruti</h4>
                            <span class="seta-baixo"></span>
                        </div>
                    </div>
                    <div class="box-kpi">
                        <div class="titulo">
                            <h2 >Setor em<span> Baixa</span></h2>
                        </div>
                        <div class="kpi-num" style="color: #2F5F98; background-color: #eff18c;">
                            788
                        </div>
                        <div class="kpi-sub-texto" style="color: #2F5F98; background-color: #eff18c;">
                            <h4>Limpeza</h4>
                        </div>
                    </div>
                    <div class="box-kpi-mes">
                        <div class="titulo">
                            <h2><span>&nbsp;</span></h2>
                        </div>
                        <div class="kpi-num">
                            <div class="titulo">
                                <h2>Dia mais popular:</h2>
                            </div>
                            <span id="diaPopular"></span>
                        </div>
                    </div>
                </div>
                <div class="grafico"><h2>Popularidade Geral ao Mês</h2>
                    <canvas id="myChart-grafico" style="width: 3px;"></canvas></div>
            </div>
        </div>
    </div>
</body>
</html>
<script>
    function exibirdiaPopular() {
        fetch('/setores/exibirDiaPopular').then(resposta => {
            if (resposta.ok) {
                resposta.json().then(data => {
                    const fluxo = data[0];
                    const spandiaPopular = document.getElementById('diaPopular');

                    spandiaPopular.innerHTML = fluxo.Dia;
                });
            } else {
                console.error("Erro ao carregar os gêneros!");
            }
        }).catch(erro => console.error(erro));
    }

const labels = [
        'Carnes',
        'Bebidas',
        'Congelados',
        'Hortifruti',
        'Limpeza',
    ];

    const data = {
        labels: labels,
        datasets: [{
        label: 'Fluxo',
        backgroundColor: ['rgb(000, 202, 220)',
        'rgb(73, 195, 251)',
        'rgb(101, 166, 250)',
        'rgb(126, 128, 231)',
        'rgb(155, 87, 204)',],
        data: [13451, 11839, 10463,10338, 8692],
        }
    ]
    };

    const config = {
        type: 'bar',
        data: data,
        options: {
            // define a direcao do grafico (horizontal)
            indexAxis: 'y',categoryPercentage: 1.0,barPercentage: 0.6,
        }
    };
    exibirdiaPopular()
</script>
<script>
    const myChart = new Chart(
      document.getElementById('myChart-grafico'),
      config
    );
</script>